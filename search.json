[{"path":"https://fishtree.fishtreeoflife.org/articles/comparative-analysis.html","id":"getting-and-cleaning-data","dir":"Articles","previous_headings":"","what":"Getting and cleaning data","title":"A simple comparative analysis with the Fish Tree of Life","text":"common hypothesis tested comparative methods whether habitat shifts drive rates diversification various groups. example, Santini et al. (2013) tested, among things, whether reef-associated pufferfishes enjoyed faster rates speciation compared non-reef relatives. First, load fishtree package download subset Fish Tree Life corresponding taxon interest. make things interesting ’ll work entire order (Tetraodontiformes) rather family 2013 study.  Next, need get habitat data associate phylogeny. rfishbase package (Boettiger et al. 2012) variety convenient functions access data recorded Fishbase editors. Load rfishbase package retrieve relevant data DemersPelag field, identifies whether species reef-associated , among things. Note replace underscores tip labels spaces. common source errors, analyses don’t seem work correctly always check whether functions ’re using expect underscores spaces. ’s lot data DemersPelag field, want know species reef-associated . ’ve also converted tip labels back underscores, since need ensure tip labels phylogeny match labels trait data. geiger package (Pennell et al. 2014) provides convenient function perform check. name.check function expects row names data object, well. ’ve identified mismatch tree data. ’ll exclude tips lacking trait data using drop.tip: also data tree, exclude using following command, isn’t necessary case: Confirm number observations tree data:","code":"library(fishtree)  tree <- fishtree_phylogeny(rank = \"Tetraodontiformes\")  plot(tree, show.tip.label = FALSE, no.margin = TRUE) library(rfishbase)  tips <- gsub(\"_\", \" \", tree$tip.label, fixed = TRUE)  fb_results <- species(species_list = tips, fields = c(\"Species\", \"DemersPelag\")) fb_results <- fb_results[!is.na(fb_results$DemersPelag), ] head(fb_results) #> # A tibble: 6 × 2 #>   Species                       DemersPelag   #>   <chr>                         <chr>         #> 1 Carinotetraodon lorteti       benthopelagic #> 2 Carinotetraodon borneensis    benthopelagic #> 3 Carinotetraodon irrubesco     benthopelagic #> 4 Carinotetraodon salivator     benthopelagic #> 5 Carinotetraodon travancoricus demersal      #> 6 Carinotetraodon imitator      benthopelagic reef <- data.frame(tip = gsub(\" \", \"_\", fb_results$Species),                    is_reef = as.numeric(fb_results$DemersPelag == \"reef-associated\")) head(reef) #>                             tip is_reef #> 1       Carinotetraodon_lorteti       0 #> 2    Carinotetraodon_borneensis       0 #> 3     Carinotetraodon_irrubesco       0 #> 4     Carinotetraodon_salivator       0 #> 5 Carinotetraodon_travancoricus       0 #> 6      Carinotetraodon_imitator       0 library(geiger) #> Loading required package: ape  rownames(reef) <- reef$tip nc <- geiger::name.check(tree, reef) nc #> $tree_not_data #>  [1] \"Lagocephalus_lagocephalus_lagocephalus\" #>  [2] \"Monotrete_cochinchinensis\"              #>  [3] \"Monotrete_leiurus\"                      #>  [4] \"Ostracion_cubicus\"                      #>  [5] \"Ostracion_immaculatus\"                  #>  [6] \"Ostracion_solorensis\"                   #>  [7] \"Paramonacanthus_filicauda\"              #>  [8] \"Rhinesomus_triqueter\"                   #>  [9] \"Sphoeroides_cheesemanii\"                #> [10] \"Stephanolepis_auratus\"                  #> [11] \"Stephanolepis_hispidus\"                 #> [12] \"Takifugu_fasciatus\"                     #> [13] \"Tetraodon_abei\"                         #> [14] \"Tetraodon_baileyi\"                      #> [15] \"Tetraodon_biocellatus\"                  #> [16] \"Tetraodon_cambodgiensis\"                #> [17] \"Tetraodon_cutcutia\"                     #> [18] \"Tetraodon_erythrotaenia\"                #> [19] \"Tetraodon_fluviatilis\"                  #> [20] \"Tetraodon_nigroviridis\"                 #> [21] \"Tetraodon_palembangensis\"               #> [22] \"Tetraodon_suvattii\"                     #> [23] \"Tetraodon_turgidus\"                     #> [24] \"Tetrosomus_fornasini\"                   #>  #> $data_not_tree #> character(0) library(ape) tree <- drop.tip(tree, nc$tree_not_data) reef <- reef[!rownames(reef) %in% nc$data_not_tree, ] Ntip(tree) == nrow(reef) #> [1] TRUE"},{"path":"https://fishtree.fishtreeoflife.org/articles/comparative-analysis.html","id":"plotting-diversification-rates","dir":"Articles","previous_headings":"","what":"Plotting diversification rates","title":"A simple comparative analysis with the Fish Tree of Life","text":"several data sources available fishtree package, including speciation rates computed via DR method (Jetz et al. 2012). Retrieve speciation rate data: ’re interested just dr column, extract convert spaces underscores . merge habitat data speciation rate data. quick check data, let’s plot histograms DR rate reef non-reef species:  seems like part, Tetraodontiformes low speciation rate, except subset non-reef species faster rate. course, comparative method, ’s critical consider historical relationships species ’re examining. following snippet code quite complex, demonstrates draw rates onto phylogeny using colored bars next tip question.","code":"rates <- fishtree_tip_rates(rank = \"Tetraodontiformes\") head(rates) #>                           species  lambda.tv      mu.tv  lambda.tc      mu.tc #> 2             Abalistes stellaris 0.08859469 0.01282721 0.09181900 0.02239813 #> 3             Abalistes stellatus 0.08859469 0.01282721 0.09181900 0.02239813 #> 34  Acanthaluteres spilomelanurus 0.10180976 0.01614045 0.16054060 0.06301037 #> 35        Acanthaluteres vittiger 0.10180976 0.01614045 0.16054060 0.06301037 #> 131    Acanthostracion polygonius 0.08549937 0.01178475 0.07697343 0.01359198 #> 132  Acanthostracion quadricornis 0.08549937 0.01178475 0.07697343 0.01359198 #>             dr #> 2   0.11678851 #> 3   0.11909205 #> 34  0.28175984 #> 35  0.28406568 #> 131 0.07606301 #> 132 0.07213440 rates <- data.frame(tip = gsub(\" \", \"_\", rates$species), dr = rates$dr) rownames(rates) <- rates$tip merged <- merge(reef, rates) breaks <- seq(min(merged$dr), max(merged$dr), length.out = 30) hist(subset(merged, is_reef == 1)$dr, col = \"orange\", density = 20, angle = 135,      breaks = breaks) hist(subset(merged, is_reef == 0)$dr, col = \"purple\", density = 20, angle = 45,      breaks = breaks, add = TRUE) # Plot tree and extract plotting data plot(tree, show.tip.label = FALSE, no.margin = TRUE) obj <- get(\"last_plot.phylo\", .PlotPhyloEnv)  # Generate a color ramp ramp <- grDevices::colorRamp(c(\"black\", \"red\"), bias = 10) tiporder <- match(rates$tip, tree$tip.label) scaled_rates <- rates$dr / max(rates$dr, na.rm = TRUE) tipcols <- apply(ramp(scaled_rates), 1, function(x) do.call(rgb, as.list(x / 255)))  # Place colored bars for (ii in 1:length(tiporder)) {     tip <- tiporder[ii]     lines(x = c(obj$xx[tip] + 0.5, obj$xx[tip] * 1.5 + 0.5 + scaled_rates[ii]),           y = rep(obj$yy[tip], 2),           col = tipcols[ii]) }"},{"path":"https://fishtree.fishtreeoflife.org/articles/comparative-analysis.html","id":"running-an-analysis","dir":"Articles","previous_headings":"","what":"Running an analysis","title":"A simple comparative analysis with the Fish Tree of Life","text":"Let’s perform quantitative analysis using using hisse. ’ll test 4 models: BiSSE-like model, BiSSE-like null model, hisse model, hisse 2 state null model. hisse package parameterizes things differently diversitree (BiSSE lives), aren’t able exactly replicate analyses Santini paper. Instead ’ll settle ensuring epsilon parameter, \\(\\epsilon = \\frac{\\mu}{\\lambda}\\) constrained equal reef non-reef taxa. ’ll also constrain transition rates equal, since can difficult estimate . Note ensure vignette can run reasonable amount time, set sann = FALSE disable simulated annealing procedure hisse. However, actual analysis option turned maximum accuracy confidence final results. First, ’ll construct run BiSSE model BiSSE null model: Next, ’ll run full hisse model, save constrained transition rates epsilon. Finally, ’ll build 2 state character independent diversification model, sometimes called CID-2. ’ll use null model forcing visible states (reef non-reef) net turnover rates, permitting hidden states vary freely. can combine results single table easy comparison. Summarizing results basis AICc suggests best supported model null model, habitat effect speciation rate.","code":"library(hisse) #> Loading required package: deSolve #> Loading required package: GenSA #> Loading required package: subplex #> Loading required package: nloptr trans.rates.bisse <- TransMatMakerHiSSE()  pp.bisse.full <- hisse(tree, reef,                        hidden.states = FALSE, sann = FALSE,                        turnover = c(1, 2), eps = c(1, 1),                        trans.rate = trans.rates.bisse) #> Warning in hisse(tree, reef, hidden.states = FALSE, sann = FALSE, turnover = #> c(1, : You have chosen to rely on the internal starting points that generally #> work but does not guarantee finding the MLE. #> Initializing...  #> Finished. Beginning bounded subplex routine...  #> Finished. Summarizing results...  pp.bisse.null <- hisse(tree, reef,                        hidden.states = FALSE, sann = FALSE,                        turnover = c(1, 1), eps = c(1, 1),                        trans.rate = trans.rates.bisse) #> Warning in hisse(tree, reef, hidden.states = FALSE, sann = FALSE, turnover = #> c(1, : You have chosen to rely on the internal starting points that generally #> work but does not guarantee finding the MLE. #> Initializing...  #> Finished. Beginning bounded subplex routine... #> Warning in log(sum(1 - compE.root)): NaNs produced #> Finished. Summarizing results... trans.rates.hisse <- TransMatMakerHiSSE(hidden.traits = 1) trans.rates.hisse <- ParEqual(trans.rates.hisse, c(1, 2, 1, 3, 1, 4, 1, 5))  pp.hisse.full <- hisse(tree, reef,                        hidden.states = TRUE, sann = FALSE,                        turnover = c(1, 2, 3, 4), eps = c(1, 1, 1, 1),                        trans.rate = trans.rates.hisse) #> Warning in hisse(tree, reef, hidden.states = TRUE, sann = FALSE, turnover = #> c(1, : You have chosen to rely on the internal starting points that generally #> work but does not guarantee finding the MLE. #> Initializing...  #> Finished. Beginning bounded subplex routine...  #> Finished. Summarizing results... pp.hisse.null2 <- hisse(tree, reef,                         hidden.states = TRUE, sann = FALSE,                         turnover = c(1, 1, 2, 2), eps = c(1, 1, 1, 1),                         trans.rate = trans.rates.hisse) #> Warning in hisse(tree, reef, hidden.states = TRUE, sann = FALSE, turnover = #> c(1, : You have chosen to rely on the internal starting points that generally #> work but does not guarantee finding the MLE. #> Initializing...  #> Finished. Beginning bounded subplex routine...  #> Finished. Summarizing results... results <- list(pp.bisse.full, pp.bisse.null, pp.hisse.null2, pp.hisse.full) aicc <- sapply(results, `[[`, \"AICc\") lnl <- sapply(results, `[[`, \"loglik\")  data.frame(model = c(\"bisse_full\", \"bisse_null\", \"hisse_cid2\", \"hisse_full\"), aicc, lnl) #>        model         aicc           lnl #> 1 bisse_full 3.188646e+32 -1.594323e+32 #> 2 bisse_null 3.188646e+32 -1.594323e+32 #> 3 hisse_cid2 3.188646e+32 -1.594323e+32 #> 4 hisse_full 3.188646e+32 -1.594323e+32"},{"path":"https://fishtree.fishtreeoflife.org/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Jonathan Chang. Author, maintainer. Michael E Alfaro. Contributor. Daniel L Rabosky. Contributor. Stephen Smith. Contributor.","code":""},{"path":"https://fishtree.fishtreeoflife.org/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Chang J, Rabosky DL, Smith SA, Alfaro (2019). “R package online resource macroevolutionary studies using ray-finned fish tree life.” Methods Ecology Evolution, 10(7), 1118-1124. ISSN 2041-210X, doi: 10.1111/2041-210x.13182. Rabosky DL, Chang J, Title PO, Cowman PF, Sallan L, Friedman M, Kaschner K, Garilao C, Near TJ, Coll M, Alfaro (2018). “inverse latitudinal gradient speciation rate marine fishes.” Nature, 559(7714), 392-395. doi: 10.1038/s41586-018-0273-1.","code":"@Article{Chang_2019,   title = {An R package and online resource for macroevolutionary studies using the ray-finned fish tree of life},   author = {Jonathan Chang and Daniel L Rabosky and Stephen A Smith and Michael E Alfaro},   journal = {Methods in Ecology and Evolution},   year = {2019},   volume = {10},   number = {7},   issn = {2041-210X},   doi = {10.1111/2041-210x.13182},   month = {Apr},   pages = {1118-1124}, } @Article{Rabosky_2018,   title = {An inverse latitudinal gradient in speciation rate for marine fishes},   volume = {559},   doi = {10.1038/s41586-018-0273-1},   number = {7714},   journal = {Nature},   year = {2018},   month = {Jul},   pages = {392-395},   author = {Daniel L Rabosky and Jonathan Chang and Pascal O Title and Peter F Cowman and Lauren Sallan and Matt Friedman and Kristin Kaschner and Cristina Garilao and Thomas J Near and Marta Coll and Michael E Alfaro}, }"},{"path":"https://fishtree.fishtreeoflife.org/index.html","id":"fishtree","dir":"","previous_headings":"","what":"Interface to the Fish Tree of Life API","title":"Interface to the Fish Tree of Life API","text":"goal fishtree provide easy interface R Fish Tree Life API, download taxonomies, phylogenies, diversification rate information, data ray-finned fishes. seamlessly integrate rest R ecosystem, especially package ape.","code":""},{"path":"https://fishtree.fishtreeoflife.org/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Interface to the Fish Tree of Life API","text":"See list taxa available download. Retrieve phylogeny surgeonfishes plot phylogeny lineage time plot. can also check vignettes detailed examples.","code":"library(fishtree)  tax <- fishtree_taxonomy() head(tax) #>         rank        name #> 1      class Actinopteri #> 2      class   Cladistia #> 3   subclass Chondrostei #> 4   subclass Neopterygii #> 5 infraclass    Holostei #> 6 infraclass   Teleostei library(ape) phy <- fishtree_phylogeny(rank = \"Acanthuridae\") phy #>  #> Phylogenetic tree with 67 tips and 66 internal nodes. #>  #> Tip labels: #>   Acanthurus_mata, Acanthurus_blochii, Acanthurus_xanthopterus, Acanthurus_bariene, Acanthurus_dussumieri, Acanthurus_leucocheilus, ... #>  #> Rooted; includes branch lengths. par(mfrow=c(2, 1)) plot(phy, show.tip.label = FALSE) ltt.plot(phy)"},{"path":"https://fishtree.fishtreeoflife.org/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Interface to the Fish Tree of Life API","text":"can install released version fishtree CRAN : Alternatively, download development version devtools:","code":"install.packages(\"fishtree\") if (!requireNamespace(\"remotes\", quietly = TRUE))     install.packages(\"remotes\")  remotes::install_github(\"jonchang/fishtree\")"},{"path":"https://fishtree.fishtreeoflife.org/index.html","id":"references","dir":"","previous_headings":"","what":"References","title":"Interface to the Fish Tree of Life API","text":"cite fishtree publications use: Chang, J., Rabosky, D. L., Smith, S. ., & Alfaro, M. E. (2019). R package online resource macroevolutionary studies using ray‐finned fish tree life. Methods Ecology Evolution, 10(7) 1118-1124. doi: 10.1111/2041-210x.13182 primary data source fishtree published part : Rabosky, D. L., Chang, J., Title, P. O., Cowman, P. F., Sallan, L., Friedman, M., Kaschner, K., Garilao, C., Near, T. J., Coll, M., Alfaro, M. E. (2018). inverse latitudinal gradient speciation rate marine fishes. Nature, 559(7714), 392–395. doi: 10.1038/s41586-018-0273-1","code":""},{"path":"https://fishtree.fishtreeoflife.org/index.html","id":"license","dir":"","previous_headings":"","what":"License","title":"Interface to the Fish Tree of Life API","text":"fishtree package licensed 2-clause BSD license.","code":""},{"path":"https://fishtree.fishtreeoflife.org/index.html","id":"sponsorship","dir":"","previous_headings":"","what":"Sponsorship","title":"Interface to the Fish Tree of Life API","text":"Please consider sponsoring maintenance fishtree via GitHub Sponsors.","code":""},{"path":"https://fishtree.fishtreeoflife.org/index.html","id":"releasing","dir":"","previous_headings":"","what":"Releasing","title":"Interface to the Fish Tree of Life API","text":"","code":"withr::with_envvar(c(\"NOT_CRAN\" = \"true\"), devtools::release())"},{"path":"https://fishtree.fishtreeoflife.org/reference/fishtree-package.html","id":null,"dir":"Reference","previous_headings":"","what":"fishtree: Interface to the Fish Tree of Life API — fishtree-package","title":"fishtree: Interface to the Fish Tree of Life API — fishtree-package","text":"fishtree makes easy access phylogenetic information ray-finned fishes R. Download taxonomies, phylogenies, sequence matrices, diversification rate data simple set functions.","code":""},{"path":"https://fishtree.fishtreeoflife.org/reference/fishtree-package.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"fishtree: Interface to the Fish Tree of Life API — fishtree-package","text":"Implementation note: package makes calls network caches (sometimes large) results faster loading. , long-running R instances use lot memory.","code":""},{"path":[]},{"path":"https://fishtree.fishtreeoflife.org/reference/fishtree-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"fishtree: Interface to the Fish Tree of Life API — fishtree-package","text":"Maintainer: Jonathan Chang @jonathanchang.org (ORCID) contributors: Michael E Alfaro [contributor] Daniel L Rabosky [contributor] Stephen Smith [contributor]","code":""},{"path":"https://fishtree.fishtreeoflife.org/reference/fishtree_alignment.html","id":null,"dir":"Reference","previous_headings":"","what":"Get aligned sequences from the Fish Tree of Life — fishtree_alignment","title":"Get aligned sequences from the Fish Tree of Life — fishtree_alignment","text":"Retrieves aligned sequence via Fish Tree Life API. neither `species` `rank` specified, returns entire sequence matrix.","code":""},{"path":"https://fishtree.fishtreeoflife.org/reference/fishtree_alignment.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get aligned sequences from the Fish Tree of Life — fishtree_alignment","text":"","code":"fishtree_alignment(species, rank, split = FALSE)"},{"path":"https://fishtree.fishtreeoflife.org/reference/fishtree_alignment.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get aligned sequences from the Fish Tree of Life — fishtree_alignment","text":"species (Optionally) subset results based vector species names. rank (Optionally) subset results based supplied taxonomic rank. split Splits output list gene locus.","code":""},{"path":"https://fishtree.fishtreeoflife.org/reference/fishtree_alignment.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get aligned sequences from the Fish Tree of Life — fishtree_alignment","text":"object class `\"DNAbin\"`, named list `split = TRUE``","code":""},{"path":"https://fishtree.fishtreeoflife.org/reference/fishtree_alignment.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Get aligned sequences from the Fish Tree of Life — fishtree_alignment","text":"Rabosky, D. L., Chang, J., Title, P. O., Cowman, P. F., Sallan, L., Friedman, M., Kashner, K., Garilao, C., Near, T. J., Coll, M., Alfaro, M. E. (2018). inverse latitudinal gradient speciation rate marine fishes. Nature, 559(7714), 392–395. doi:10.1038/s41586-018-0273-1","code":""},{"path":[]},{"path":"https://fishtree.fishtreeoflife.org/reference/fishtree_alignment.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get aligned sequences from the Fish Tree of Life — fishtree_alignment","text":"","code":"if (FALSE) { surgeon_dna <- fishtree_alignment(rank = \"Acanthuridae\", split = TRUE) surgeon_dna[[1]] par(mfrow = c(9, 3), mar = c(0.5, 0.5, 1, 0.5), xaxt = \"n\", yaxt = \"n\") for (gene in names(surgeon_dna)) {   image(surgeon_dna[[gene]], legend = FALSE, show.labels = FALSE)   title(gene) } }"},{"path":"https://fishtree.fishtreeoflife.org/reference/fishtree_complete_phylogeny.html","id":null,"dir":"Reference","previous_headings":"","what":"Get complete (stochastically-resolved) phylogenies from the Fish Tree of Life — fishtree_complete_phylogeny","title":"Get complete (stochastically-resolved) phylogenies from the Fish Tree of Life — fishtree_complete_phylogeny","text":"Retrieves complete phylogeny generated stochastic polytomy resolution via Fish Tree Life API. neither `species` `rank` specified, returns entire phylogeny. See Rabosky et al. (2018) Chang et al. (2019) details phylogenies built using stochastic polytomy resolution. WARNING: phylogenies generally used downstream analyses trait evolution. See Rabosky (2015) details.","code":""},{"path":"https://fishtree.fishtreeoflife.org/reference/fishtree_complete_phylogeny.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get complete (stochastically-resolved) phylogenies from the Fish Tree of Life — fishtree_complete_phylogeny","text":"","code":"fishtree_complete_phylogeny(   species,   rank,   mc.cores = getOption(\"mc.cores\", 1L) )"},{"path":"https://fishtree.fishtreeoflife.org/reference/fishtree_complete_phylogeny.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get complete (stochastically-resolved) phylogenies from the Fish Tree of Life — fishtree_complete_phylogeny","text":"species (Optionally) subset results based vector species names. rank (Optionally) subset results based supplied taxonomic rank. mc.cores Number cores use mclapply subsetting tree (default `1`)","code":""},{"path":"https://fishtree.fishtreeoflife.org/reference/fishtree_complete_phylogeny.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get complete (stochastically-resolved) phylogenies from the Fish Tree of Life — fishtree_complete_phylogeny","text":"object class `\"multiPhylo\"` probably used analyses trait evolution, including (limited ) pic, ace, corBrownian, make.bisse, hisse.","code":""},{"path":"https://fishtree.fishtreeoflife.org/reference/fishtree_complete_phylogeny.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Get complete (stochastically-resolved) phylogenies from the Fish Tree of Life — fishtree_complete_phylogeny","text":"Rabosky, D. L. (2015). substitute real data: cautionary note use phylogenies birth-death polytomy resolvers downstream comparative analyses. Evolution, 69(12), 3207–3216. doi:10.1111/evo.12817 Rabosky, D. L., Chang, J., Title, P. O., Cowman, P. F., Sallan, L., Friedman, M., Kashner, K., Garilao, C., Near, T. J., Coll, M., Alfaro, M. E. (2018). inverse latitudinal gradient speciation rate marine fishes. Nature, 559(7714), 392–395. doi:10.1038/s41586-018-0273-1 Chang, J., Rabosky, D. L., & Alfaro, M. E. (2019). Estimating diversification rates incompletely-sampled phylogenies: theoretical concerns practical solutions. Systematic Biology. doi:10.1093/sysbio/syz081 Enhanced polytomy resolution strengthens evidence global gradient speciation rate marine fishes. https://fishtreeoflife.org/rabosky-et-al-2018-update/","code":""},{"path":"https://fishtree.fishtreeoflife.org/reference/fishtree_complete_phylogeny.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get complete (stochastically-resolved) phylogenies from the Fish Tree of Life — fishtree_complete_phylogeny","text":"","code":"if (FALSE) { tree <- fishtree_complete_phylogeny(rank = \"Acanthuridae\") sampled_tips <- fishtree_phylogeny(rank = \"Acanthuridae\")$tip.label all_tips <- tree[[1]]$tip.label new_tips <- setdiff(all_tips, sampled_tips) par(mfrow = c(2,2)) for (ii in 1:4) {   plot(tree[[ii]], show.tip.label = FALSE, no.margin = TRUE)   ape::tiplabels(pch = 19, col = ifelse(tree[[ii]]$tip.label %in% new_tips, \"red\", NA)) } }"},{"path":"https://fishtree.fishtreeoflife.org/reference/fishtree_phylogeny.html","id":null,"dir":"Reference","previous_headings":"","what":"Get a phylogeny from the Fish Tree of Life — fishtree_phylogeny","title":"Get a phylogeny from the Fish Tree of Life — fishtree_phylogeny","text":"Retrieves phylogeny via Fish Tree Life API. neither `species` `rank` specified, returns entire phylogeny.","code":""},{"path":"https://fishtree.fishtreeoflife.org/reference/fishtree_phylogeny.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get a phylogeny from the Fish Tree of Life — fishtree_phylogeny","text":"","code":"fishtree_phylogeny(   species,   rank,   type = c(\"chronogram\", \"phylogram\", \"chronogram_mrca\", \"phylogram_mrca\") )"},{"path":"https://fishtree.fishtreeoflife.org/reference/fishtree_phylogeny.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get a phylogeny from the Fish Tree of Life — fishtree_phylogeny","text":"species (Optionally) subset results based vector species names. rank (Optionally) subset results based supplied taxonomic rank. type Either `\"chronogram\"` `\"phylogram\"`. chronogram branch lengths proportional units time, phylogram branch lengths proportional amount character change. retrieving phylogeny rank, rank recovered monophyletic, acceptable types also include `\"chronogram_mrca\"` `\"phylogram_mrca\"`, returns tree ** species descending common ancestor species specified rank.","code":""},{"path":"https://fishtree.fishtreeoflife.org/reference/fishtree_phylogeny.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get a phylogeny from the Fish Tree of Life — fishtree_phylogeny","text":"object class `\"phylo\"`.","code":""},{"path":"https://fishtree.fishtreeoflife.org/reference/fishtree_phylogeny.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get a phylogeny from the Fish Tree of Life — fishtree_phylogeny","text":"maximum interoperability, `species` considers spaces underscores equivalently. Internally, phylogenies use underscores.","code":""},{"path":"https://fishtree.fishtreeoflife.org/reference/fishtree_phylogeny.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Get a phylogeny from the Fish Tree of Life — fishtree_phylogeny","text":"Rabosky, D. L., Chang, J., Title, P. O., Cowman, P. F., Sallan, L., Friedman, M., Kashner, K., Garilao, C., Near, T. J., Coll, M., Alfaro, M. E. (2018). inverse latitudinal gradient speciation rate marine fishes. Nature, 559(7714), 392–395. doi:10.1038/s41586-018-0273-1","code":""},{"path":[]},{"path":"https://fishtree.fishtreeoflife.org/reference/fishtree_phylogeny.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get a phylogeny from the Fish Tree of Life — fishtree_phylogeny","text":"","code":"if (FALSE) { # Get a phylogeny for a taxonomic rank surgeons <- fishtree_phylogeny(rank = \"Acanthuridae\")  # Get a phylogeny for only certain species genomic_fish <- c(\"Oryzias latipes\", \"Tetraodon nigroviridis\",                   \"Gasterosteus aculeatus\", \"Danio rerio\") fishtree_phylogeny(species = genomic_fish)  # Chronograms may not be ultrametric due to numerical precision issues # Consider using phytools::force.ultrametric ape::is.ultrametric(surgeons) ape::is.ultrametric(surgeons, tol = 0.00001)  # Difference between MRCA trees and regular trees gobies_mrca <- fishtree_phylogeny(rank = \"Gobiidae\", type = \"chronogram_mrca\") gobies <- fishtree_phylogeny(rank = \"Gobiidae\", type = \"chronogram\") # MRCA trees will have more tips for non-monophyletic groups length(gobies_mrca$tip.label) > length(gobies$tip.label) # Drop rogue tips in the MRCA tree rogue_gobies <- fishtree_rogues(\"Gobiidae\") pruned_gobies <- ape::drop.tip(gobies_mrca, rogue_gobies) # Now the trees are identical setequal(gobies$tip.label, pruned_gobies$tip.label) }"},{"path":"https://fishtree.fishtreeoflife.org/reference/fishtree_rogues.html","id":null,"dir":"Reference","previous_headings":"","what":"Get rogue taxa that break the monophyly of defined taxa — fishtree_rogues","title":"Get rogue taxa that break the monophyly of defined taxa — fishtree_rogues","text":"groups recovered paraphyletic phylogenetic analysis, uses Fish Tree Life API identify species prevented clade recovered monophyletic.","code":""},{"path":"https://fishtree.fishtreeoflife.org/reference/fishtree_rogues.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get rogue taxa that break the monophyly of defined taxa — fishtree_rogues","text":"","code":"fishtree_rogues(rank)"},{"path":"https://fishtree.fishtreeoflife.org/reference/fishtree_rogues.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get rogue taxa that break the monophyly of defined taxa — fishtree_rogues","text":"rank (possibly paraphyletic) rank rogue intruder species identified.","code":""},{"path":"https://fishtree.fishtreeoflife.org/reference/fishtree_rogues.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get rogue taxa that break the monophyly of defined taxa — fishtree_rogues","text":"vector species names, potentially empty.","code":""},{"path":"https://fishtree.fishtreeoflife.org/reference/fishtree_rogues.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Get rogue taxa that break the monophyly of defined taxa — fishtree_rogues","text":"Rabosky, D. L., Chang, J., Title, P. O., Cowman, P. F., Sallan, L., Friedman, M., Kashner, K., Garilao, C., Near, T. J., Coll, M., Alfaro, M. E. (2018). inverse latitudinal gradient speciation rate marine fishes. Nature, 559(7714), 392–395. doi:10.1038/s41586-018-0273-1","code":""},{"path":"https://fishtree.fishtreeoflife.org/reference/fishtree_rogues.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get rogue taxa that break the monophyly of defined taxa — fishtree_rogues","text":"","code":"if (FALSE) { fishtree_rogues(\"Gobiidae\")   # several rogue taxa! fishtree_rogues(\"Labridae\")   # nice and monophlyetic }"},{"path":"https://fishtree.fishtreeoflife.org/reference/fishtree_taxonomy.html","id":null,"dir":"Reference","previous_headings":"","what":"Get taxonomies and other data from the Fish Tree of Life — fishtree_taxonomy","title":"Get taxonomies and other data from the Fish Tree of Life — fishtree_taxonomy","text":"Retrieves taxonomic information Fish Tree Life API.","code":""},{"path":"https://fishtree.fishtreeoflife.org/reference/fishtree_taxonomy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get taxonomies and other data from the Fish Tree of Life — fishtree_taxonomy","text":"","code":"fishtree_taxonomy(ranks = NULL)"},{"path":"https://fishtree.fishtreeoflife.org/reference/fishtree_taxonomy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get taxonomies and other data from the Fish Tree of Life — fishtree_taxonomy","text":"ranks One taxonomic ranks retrieve.","code":""},{"path":"https://fishtree.fishtreeoflife.org/reference/fishtree_taxonomy.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get taxonomies and other data from the Fish Tree of Life — fishtree_taxonomy","text":"list, components containing data specified taxa. `ranks` unspecified, data frame valid taxa returned instead.","code":""},{"path":"https://fishtree.fishtreeoflife.org/reference/fishtree_taxonomy.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Get taxonomies and other data from the Fish Tree of Life — fishtree_taxonomy","text":"Rabosky, D. L., Chang, J., Title, P. O., Cowman, P. F., Sallan, L., Friedman, M., Kashner, K., Garilao, C., Near, T. J., Coll, M., Alfaro, M. E. (2018). inverse latitudinal gradient speciation rate marine fishes. Nature, 559(7714), 392–395. doi:10.1038/s41586-018-0273-1","code":""},{"path":"https://fishtree.fishtreeoflife.org/reference/fishtree_taxonomy.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get taxonomies and other data from the Fish Tree of Life — fishtree_taxonomy","text":"","code":"if (FALSE) { tax <- fishtree_taxonomy(rank = \"Labridae\") n_total <- length(tax$Labridae$species) n_sampl <- length(tax$Labridae$sampled_species) paste(\"There are\", n_sampl, \"sampled species out of\", n_total, \"in wrasses.\") }"},{"path":"https://fishtree.fishtreeoflife.org/reference/fishtree_tip_rates.html","id":null,"dir":"Reference","previous_headings":"","what":"Get tip rates for the Fish Tree of Life — fishtree_tip_rates","title":"Get tip rates for the Fish Tree of Life — fishtree_tip_rates","text":"Downloads tip rates entire Fish Tree Life, specified subset. Tip rates can thought instantaneous speciation extinction rate; example, higher tip-specific speciation rate might imply lineage likely split new lineage present time. See Title (2019) references details. neither `species` `rank` specified, returns entire set tip-specific diversification rates.","code":""},{"path":"https://fishtree.fishtreeoflife.org/reference/fishtree_tip_rates.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get tip rates for the Fish Tree of Life — fishtree_tip_rates","text":"","code":"fishtree_tip_rates(species, rank, sampled_only = TRUE)"},{"path":"https://fishtree.fishtreeoflife.org/reference/fishtree_tip_rates.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get tip rates for the Fish Tree of Life — fishtree_tip_rates","text":"species (Optionally) subset results based vector species names. rank (Optionally) subset results based supplied taxonomic rank. sampled_only Restricts returned dataset species genetic data available. Defaults `TRUE`.","code":""},{"path":"https://fishtree.fishtreeoflife.org/reference/fishtree_tip_rates.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get tip rates for the Fish Tree of Life — fishtree_tip_rates","text":"data frame. Columns ending `.tv` indicate time-variable BAMM runs; ending `.tc` time-constant runs. `dr` column refers DR statistic, `lambda` `mu` speciation extinction, respectively.","code":""},{"path":"https://fishtree.fishtreeoflife.org/reference/fishtree_tip_rates.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Get tip rates for the Fish Tree of Life — fishtree_tip_rates","text":"DR rates (supplement, section 1.2.2): Jetz, W., Thomas, G. H., Joy, J. B., Hartmann, K., & Mooers, . O. (2012). global diversity birds space time. Nature, 491(7424), 444–448. doi:10.1038/nature11631 Interpreting tip rates: Title, P. O., & Rabosky, D. L. (2019). Tip rates, phylogenies diversification: estimating, good estimates? Methods Ecology Evolution, 10(6), 821–834. doi:10.1111/2041-210x.13153 BAMM rates: Rabosky, D. L. (2014). Automatic Detection Key Innovations, Rate Shifts, Diversity-Dependence Phylogenetic Trees. PLoS ONE, 9(2), e89543. doi:10.1371/journal.pone.0089543 Rabosky, D. L., Chang, J., Title, P. O., Cowman, P. F., Sallan, L., Friedman, M., Kashner, K., Garilao, C., Near, T. J., Coll, M., Alfaro, M. E. (2018). inverse latitudinal gradient speciation rate marine fishes. Nature, 559(7714), 392–395. doi:10.1038/s41586-018-0273-1 Enhanced polytomy resolution strengthens evidence global gradient speciation rate marine fishes. https://fishtreeoflife.org/rabosky-et-al-2018-update/","code":""},{"path":"https://fishtree.fishtreeoflife.org/reference/fishtree_tip_rates.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get tip rates for the Fish Tree of Life — fishtree_tip_rates","text":"","code":"if (FALSE) { # Get cichlid rates and trees rates <- fishtree_tip_rates(rank = \"Cichlidae\") tree <- fishtree_phylogeny(rank = \"Cichlidae\")  # Plot tree and extract plotting data plot(tree, show.tip.label = FALSE) obj <- get(\"last_plot.phylo\", ape::.PlotPhyloEnv)  # Generate a color ramp ramp <- grDevices::colorRamp(c(\"black\", \"red\"), bias = 10) tiporder <- match(rates$species, gsub(\"_\", \" \", tree$tip.label)) scaled_rates <- rates$lambda.tv / max(rates$lambda.tv, na.rm = TRUE) tipcols <- apply(ramp(scaled_rates), 1, function(x) do.call(rgb, as.list(x / 255)))  # Place colored bars for (ii in 1:length(tiporder)) {     tip <- tiporder[ii]     lines(x = c(obj$xx[tip] + 0.5, obj$xx[tip] + 0.5 + scaled_rates[ii]),           y = rep(obj$yy[tip], 2),           col = tipcols[ii]) } }"},{"path":[]},{"path":"https://fishtree.fishtreeoflife.org/news/index.html","id":"fishtree-034","dir":"Changelog","previous_headings":"","what":"fishtree 0.3.4","title":"fishtree 0.3.4","text":"CRAN release: 2021-01-30 release fixes tests, new user-facing features.","code":""},{"path":"https://fishtree.fishtreeoflife.org/news/index.html","id":"fishtree-033","dir":"Changelog","previous_headings":"","what":"fishtree 0.3.3","title":"fishtree 0.3.3","text":"CRAN release: 2020-10-31 internal .get() function now avoids build-time dependency memoise::memoise(), per https://github.com/r-lib/memoise/issues/76 Vignettes citations updated use latest versions, relevant.","code":""},{"path":"https://fishtree.fishtreeoflife.org/news/index.html","id":"fishtree-032","dir":"Changelog","previous_headings":"","what":"fishtree 0.3.2","title":"fishtree 0.3.2","text":"CRAN release: 2019-12-17 fishtree_alignment() now works correctly species = ... arguments. internal .name_check function now emits structured warning output. means users supplying species names e.g., fishtree_phylogeny matches taxonomy may use functions capture warning messages programmatically determine species missing, without parsing error messages. Converted warnings messages. Minor documentation changes.","code":""},{"path":"https://fishtree.fishtreeoflife.org/news/index.html","id":"fishtree-031","dir":"Changelog","previous_headings":"","what":"fishtree 0.3.1","title":"fishtree 0.3.1","text":"CRAN release: 2019-05-31 fishtree_tip_rates now warns missing / invalid species.","code":""},{"path":"https://fishtree.fishtreeoflife.org/news/index.html","id":"fishtree-030","dir":"Changelog","previous_headings":"","what":"fishtree 0.3.0","title":"fishtree 0.3.0","text":"CRAN release: 2019-04-03 New function: fishtree_complete_phylogeny, gets complete phylogenies unsampled taxa placed using stochastic polytomy resolution. Use package memoise instead rolling caching functionality. New global option fishtree.quiet: set FALSE, verbose downloads (can help debugging issues). internal reorganization.","code":""},{"path":"https://fishtree.fishtreeoflife.org/news/index.html","id":"fishtree-020","dir":"Changelog","previous_headings":"","what":"fishtree 0.2.0","title":"fishtree 0.2.0","text":"CRAN release: 2019-02-26 New function: fishtree_rogues, identifies rogue/intruder taxa break monophyly selected group. fishtree_phylogeny now permits downloads MRCA trees paraphyletic groups. Suggested anonymous reviewer. fishtree_taxonomy revamped. now takes single argument ranks = ... can retrieve taxonomic information valid taxonomic rank taxonomy. Calling without arguments returns data frame valid taxa names. Suggested anonymous reviewer.","code":""},{"path":"https://fishtree.fishtreeoflife.org/news/index.html","id":"fishtree-010","dir":"Changelog","previous_headings":"","what":"fishtree 0.1.0","title":"fishtree 0.1.0","text":"CRAN release: 2018-11-30 Initial release.","code":""}]
